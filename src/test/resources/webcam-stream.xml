<container>
    
    <stream id="video" class="stream.io.DataObjectStream"
    		url="file:/Volumes/RamDisk/bwinf-stream.obj" />
    		<!-- 
    		url="tcp://192.168.129.98:9100" />
    		url="file:/Volumes/RamDisk/webcam.mjpeg" />
    		 -->
    
    <process input="video">
		<CreateID key="frame:id" />
		<!-- 
		<PrintData />
		 -->
		 
		<stream.image.AverageRGB />
        
        <stream.flow.Skip condition="%{data.frame:blue:avg} == null " />
        <stream.image.DetectBrokenImage />
        <If condition="%{data.data:broken} @gt 0.5">
            <Skip/>
        </If>
		<stream.image.DisplayImage image="data" />
        
    	<stream.PeakCount keys="frame:blue:avg" />
    	<SetValue key="dummy" value="0.0" />
    	<stream.parser.ParseDouble keys="dummy" />
    	
    	<Enqueue queue="capsules" condition="%{data.peak} @gt 0.0" />
    
        <stream.plotter.Plotter
            history="1000"
            keepOpen="true"
            keys="frame:red:avg,frame:blue:avg,frame:green:avg,dummy,peak" />
		 
		<!-- 
		<stream.io.DataObjectWriter file="/Volumes/RamDisk/bwinf-stream.obj" />
		 <Delay time="35ms" />
		 -->
    </process>
    
	<process input="capsules">
	    <PrintData />
	</process>

</container>